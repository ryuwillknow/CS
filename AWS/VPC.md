# VPC

## 선수 지식

IP : 장치를 식별할 수 있도록 각각의 장비에게 부여되는 **고유 주소**이다.

네트워크 3자리 + 호스트 1자리?? 이거 

아이피는 일반적으로 마침표로 구분된 4개의 숫자가 있다. 32비트를 10진수로 표현한다. 

아이피는 네트워크 ID와 호스트 ID로 구성된다. 

네트워크 ID는 모든 호스트를 관리하기 힘들기 때문에 한 네트워크의 범위를 지정한 ID이다.

호스트 ID는 각각의 호스트를 관리하기 위해 사용한다.

IP 주소는 클래스가 있다. 

IP클래스는 예전에 IPv4를 사용했을 떄 IP를 할당하는 방법이었다. 지금은 더이상 사용하지 않고 CIDR방식으로 바뀌었다. 1993년에. 서브네팅의 기본개념을 알아야한다. 

A 첫자리 0 (0 - 127, 호스트 3자리)  B 10 (129 - 191, 호스트 2자리) C 110  (192 - 223, 호스트 1자리) D 1110 (224 - 239)  E 1111 ( 240 - 255)

**호스트 처음은 네트워크 자체를 지칭한다**. 마지막 주소는 브로드캐스트용 주소로 쓰인다.

**하지만 네트워크를 할당받았는데 호스트 주소개수가 맞지않아 비효율이 생긴다. ⇒ 서브넷 사용**

서브넷은 하나의 네트워크가 분할되어 나눠진 작은 네트워크이다. 

서브넷을 분할하기 이해 네트워크를 분할하는 것을 서브네팅이라고 한다.

서브네팅은 서브넷 마스크를 통하여 계산되어 수행된다.

서브넷 마스크는 IP주소와 똑같은 32비트 2진수로 표현되지만 연속된 1과 연속된 0으로만 구성된다는 차이가 있다.

prefix표현을 통해 간략하게 표현할 수 있다. + 클래스를 앞자리로 확인하고 슈퍼네팅인지 서브네팅인지 확인할 수 있다.

사설망 ip는 중복이 가능하다!!! 그래서 수많은 ip 감당할 수 있다.

사설IP 주소는 다음 3가지 주소대역으로 고정된다.

- Class A : **10**.0.0.0 ~ **10**.255.255.255
- Class B : **172.16**.0.0 ~ **172.31**.255.255
- Class C : **192.168**.0.0 ~ **192.168**.255.255

## CIDR

서브네팅을 품고 있다. prefix가 사실 CIDR

0.0.0.0/0 이렇게 표기하는게 CIDR표기법이다.

192.168.10.70/26 풀이법  네트워크 2에 해당한다. 클래스 c이지만 26이므로 4개로 나눈것이다. 64 이상이므로 2번째 네트워크에 해당한다.

보통이라면 IP주소범위의 가장 처음과 끝을 네트워크 주소(10.0.0.0) 브로드캐스트 주소(10.0.0.255)로서 **2개**만 제외하고 나머지는 사용할수있는 IP 주소겠지만, AWS에서는 따로 자체 클라우드에서 설정해 사용하고있는 IP가 있기 때문에 총 **5개**를 제외하여야 한다.

| 10.0.0.0 | 네트워크 주소 (Network ID) |
| --- | --- |
| 10.0.0.1 | AWS에서 VPC 라우터용으로 예약 (Default Gateway) |
| 10.0.0.2 | DNS 서버 주소DNS 서버의 IP 주소는 기본 VPC 네트워크 범위에 2를 더한 주소이다.CIDR 블록이 여러 개인 VPC의 경우, DNS 서버의 IP 주소가 기본 CIDR에 위치하게 된다. |
| 10.0.0.3 | AWS에서 앞으로 사용하려고 예약한 주소 |
| 10.0.0.255 | 네트워크 브로드캐스트 주소 |

## 리전, 엣지

**AZ-A, AZ-B, AZ-C** 이런식으로 가용영역을 매핑하여 중간단계 같이 배치해주는데, 이는 보안이나 한 AZ로 트래픽 몰림을 방지하기 위함이다. 계정마다 가용영역을 랜덤으로 매핑함으로서 user A와 user B간의 저장소를 랜덤으로 배치하게 하여, user A가 민감한 데이터를 저장해도 어디 데이터 센터에 저장되는지 추측할수 없게 되어 보안적인 효과를 얻을 수 있다.

엣지 로케이션은 aws의 cdn들의 여러 서비스들을 가장 빠른 속도로 제공(캐싱) 하기 위한 **거점**이다. 전 세계에 여러 장소에 흩어져 있다.
AWS의 CDN 서비스인 **CloudFront**과 AWS의 DNS 서비스인 **Route53**의 **캐시 서버**를 의미한다.

CDN(Contents Delivery Network) 서비스는 콘텐츠를 보다 빠르게 전송하는 기술로, 속도 개선과 회선 비용 절감에 용이하다.

최초 요청 시에는 서버로부터 콘텐츠를 가져와 고객에게 전송하며, 동시에 CDN 캐싱장비에 저장한다.

이후에는 CDN 캐싱 장비에 저장된 콘텐츠를 바로 전송하는 방식이다.

CDN 업체에서 지정하는 컨텐츠 만료 지점까지 호출이 없으면 주기적으로 삭제한다.

AZ는 복사의 개념이 아니다.

## VPC 실전

**각 계정 별로 부여된 AZ의 코드와 실제 위치가 다르다는 점**

각 계정의 유저들이 데이터를 저장할때, 하나의 데이터 센터에만 저장을 하지 않게 하고, 각 센터에 이리저리 분산함으로서 트래픽 몰림을 방지할수 있다. (사진 처럼 각 계정마다 데이터센터 연결선이 다르니까)

따라서 여러개의 가용영역에 서버를 올려 사용하여 로드밸런싱을 통하여 트래픽을 분산시켜 한쪽 가용영역이 작동을 안하더라도 무중단 서비스를 제공할 수 있는 것이다.
